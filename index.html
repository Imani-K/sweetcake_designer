<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SweetCake Designer üç∞</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background: #fff;
    }
    .parallax {
      background-image: url('https://i.imgur.com/k2jK8M7.png');
      height: 300px;
      background-attachment: fixed;
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: white;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin-top: -100px;
      position: relative;
      z-index: 1;
    }
    h2, h3 {
      color: #d63384;
      text-align: center;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
    }
    select, input, button {
      display: block;
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      margin-bottom: 15px;
      font-size: 16px;
    }
    button {
      background-color: #ff4da6;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #e03b92;
    }
    .ai-chat {
      background: #f9f9f9;
      padding: 15px;
      border-radius: 10px;
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 15px;
      border: 1px solid #ddd;
    }
    .ai-msg {
      background: #eee;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 5px;
    }
    .user-msg {
      background: #d1e7dd;
      text-align: right;
    }
    .cake-preview {
      text-align: center;
      margin-top: 20px;
    }
    .cake-preview img {
      max-width: 100%;
      max-height: 200px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    #orderList li {
      margin-bottom: 8px;
      background: #ffeaf4;
      padding: 8px;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    #orderList {
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <div class="parallax"></div>

  <div class="container">
    <h2>üéÇ Customize Your Cake</h2>
    <label for="shape">Shape:</label>
    <select id="shape">
      <option>Round</option>
      <option>Square</option>
      <option>Heart</option>
    </select>

    <label for="flavor">Flavor:</label>
    <select id="flavor">
      <option>Vanilla</option>
      <option>Chocolate</option>
      <option>Strawberry</option>
      <option>Caramel</option>
    </select>

    <label for="toppings">Toppings:</label>
    <select id="toppings" multiple>
      <option>Sprinkles</option>
      <option>Fruits</option>
      <option>Chocolate</option>
      <option>Nuts</option>
      <option>Cherry</option>
    </select>

    <button onclick="placeOrder()">Place My Cake Order</button>

    <h2>ü§ñ Ask AI for Cake Ideas</h2>
    <input type="text" id="userInput" placeholder="Ask something..." />
    <button onclick="sendMessage()">Ask AI</button>

    <div class="ai-chat" id="chatBox">
      <div class="ai-msg">Hi! I'm your cake assistant üç∞</div>
    </div>

    <div class="cake-preview" id="cakePreview" style="display: none;">
      <h3>üé® Cake Preview</h3>
      <img id="cakeImage" src="" alt="Cake Image" />
    </div>

    <div id="orderHistory" style="margin-top: 30px;">
      <h3>üìù Your Orders</h3>
      <ul id="orderList"></ul>
    </div>
  </div>

  <script>
    function placeOrder() {
      const shape = document.getElementById('shape').value;
      const flavor = document.getElementById('flavor').value;
      const toppings = Array.from(document.getElementById('toppings').selectedOptions).map(opt => opt.value);
      const toppingList = toppings.length ? toppings.join(', ') : 'None';

      alert(`üéÇ Cake Order\nShape: ${shape}\nFlavor: ${flavor}\nToppings: ${toppingList}`);

      const orderList = document.getElementById('orderList');
      const li = document.createElement('li');
      li.textContent = `üßÅ ${shape} | ${flavor} | Toppings: ${toppingList}`;
      orderList.appendChild(li);
    }

    async function sendMessage() {
      const input = document.getElementById('userInput');
      const chat = document.getElementById('chatBox');
      const userText = input.value.trim();
      if (!userText) return;

      const userMsg = document.createElement('div');
      userMsg.className = 'ai-msg user-msg';
      userMsg.innerText = userText;
      chat.appendChild(userMsg);

      const res = await fetch('/ask-ai', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message: userText })
      });

      const data = await res.json();
      const aiMsg = document.createElement('div');
      aiMsg.className = 'ai-msg';
      aiMsg.innerText = data.reply;
      chat.appendChild(aiMsg);
      chat.scrollTop = chat.scrollHeight;
      showCakeImage();

      input.value = '';
    }

    function showCakeImage() {
      const shape = document.getElementById('shape').value.toLowerCase();
      const flavor = document.getElementById('flavor').value.toLowerCase();
      let imageUrl = '';

      if (shape === 'round' && flavor === 'vanilla') {
        imageUrl = 'https://i.imgur.com/Y4Gp9CV.png';
      } else if (shape === 'round' && flavor === 'chocolate') {
        imageUrl = 'https://i.imgur.com/k2jK8M7.png';
      } else if (shape === 'square' && flavor === 'vanilla') {
        imageUrl = 'https://i.imgur.com/wfL3k2f.png';
      } else if (shape === 'square' && flavor === 'chocolate') {
        imageUrl = 'https://i.imgur.com/z0mRAoI.png';
      } else if (shape === 'heart' && flavor === 'strawberry') {
        imageUrl = 'https://i.imgur.com/NjcacV4.png';
      } else {
        imageUrl = 'https://i.imgur.com/sJ3CT4K.png';
      }

      const preview = document.getElementById('cakePreview');
      const img = document.getElementById('cakeImage');
      img.src = imageUrl;
      preview.style.display = 'block';
    }
  </script>
</body>
</html>
